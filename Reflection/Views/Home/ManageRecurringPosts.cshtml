@{
    Layout = "";
}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" />
    <link href="~/CSS/ManageRecurringPosts.css" rel="stylesheet" type="text/css" />
    <title>Screen3</title>
</head>

<body>
    <div class="container">
        <!-- Modal -->
        <div class="" role="document">
            <div class="modal-content custom-mc">
                <div class="modal-body modal-mb-sc2">
                    <div class="recurring">Recurring posts</div>
                    <div class="recu-desc">
                        View and manage recurring posts below. Previous posts will not be affected
                        and any changes will automatically apply only
                        to future posts.
                    </div>
                    <table class="table custom-tb">
                        <thead>
                            <tr>
                                <th scope="col" class="qutin">Question<span id="questioncount"></span></th>
                                <th scope="col" class="anonymous">Privacy</th>
                                <th scope="col" class="snd-post">Send post at</th>
                            </tr>
                        </thead>
                        <tbody id="tablebody">
                        </tbody>
                    </table>
                </div>
                <div class="mf">
                    <div class="float-left">
                        <span class="left-chev"></span>
                       Back
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <script src="@("https://unpkg.com/@microsoft/teams-js@1.4.1/dist/MicrosoftTeams.min.js")"></script>
    <script>
        $(document).ready(function () {
            var blockdata = ""
            $.ajax({
                type: 'GET',
                url: 'api/GetRecurssions',
                success: function (data) {
                    recurssions = JSON.parse(JSON.parse(data).recurssions);
                    $("#questioncount").html("("+recurssions.length+")");
                    daysInWeek = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
                    var sendpostat = "";
                    recurssions.forEach(x => {
                        if (x.RecurssionType == "Monthly") {
                            sendpostat = "Every Month " + new Date(x.RefCreatedDate).getDate()+" at "+new Date(x.RefCreatedDate).toLocaleTimeString('en-US', { hour: 'numeric', hour12: true, minute: 'numeric' });
                        }
                        else if (x.RecurssionType == "Weekly") {
                            sendpostat = "Every Week " + daysInWeek[new Date(x.RefCreatedDate).getDay()] + " at " + new Date(x.RefCreatedDate).toLocaleTimeString('en-US', { hour: 'numeric', hour12: true, minute: 'numeric' });
                        }
                        else {
                            sendpostat="Every Week Day"
                        }
                        blockdata = blockdata + '<tr><td class="hw-r-u">' + x.Question + '<div class="hru-desc">Created by: ' + x.CreatedBy + ' on ' + new Date(x.RefCreatedDate).toDateString() + '</div></td><td>' + x.Privacy + '</td> <td class="date-day">'+sendpostat+'</td></tr>';
                    })
                    $("#tablebody").html(blockdata);


                }
            });
        });
    </script>
</body>


</html>